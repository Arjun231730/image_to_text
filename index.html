<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üß† SpaceOCR Text Extractor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      display: flex;
      gap: 30px;
    }
    .left, .right {
      width: 50%;
    }
    textarea {
      width: 100%;
      height: 500px;
      font-size: 16px;
    }
    img {
      max-width: 100%;
      max-height: 500px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

  <div class="left">
    <h2>üß† Upload Image to Extract Text</h2>
    <input type="file" id="imageInput" accept="image/*" onchange="showImage(event)">
    <button onclick="extractText()">Extract Text</button>
    <p id="status" style="color:red;"></p>
    <textarea id="result" placeholder="Formatted extracted text will appear here..."></textarea>
  </div>

  <div class="right">
    <h3>üì∑ Uploaded Image</h3>
    <img id="preview" src="#" alt="Image Preview">
  </div>

  <script>
    function showImage(event) {
      const image = document.getElementById("preview");
      image.src = URL.createObjectURL(event.target.files[0]);
    }

    function formatText(text) {
      // Remove '^' for space
      text = text.replace(/\^/g, ' ');

      // Add <U> for domain name
      text = text.replace(/^Domain Name\s*:\s*(.*)$/im, "Domain Name: <U>$1</U>");

      // Add <I><U> for any email field
      text = text.replace(/^.*Email\s*:\s*(.*)$/gim, (match, p1) => {
        return match.replace(p1, `<I><U>${p1}</U></I>`);
      });

      // Add <R><B> for Domain Status
      text = text.replace(/^Domain Status\s*:\s*(.*)$/im, "Domain Status: <R><B>$1</B></R>");

      // Replace common short forms
      const replacements = {
        "\\bInc\\b\\.?": "Incorporation",
        "\\bLtd\\b\\.?": "Limited",
        "\\bAve\\b\\.?": "Avenue",
        "\\bCt\\b\\.?": "Court",
        "\\bSte\\b\\.?": "Suite",
        "\\bPkwy\\b\\.?": "Parkway",
        "\\bLn\\b\\.?": "Lane",
        "\\bDr\\b\\.?": "Drive",
        "\\bPl\\b\\.?": "Place",
        "\\bBlvd\\b\\.?": "Boulevard",
        "\\bApt\\b\\.?": "Apartment",
        "\\bRd\\b\\.?": "Road",
        "\\bPvt\\b\\.?": "Private",
        "\\bCorp\\b\\.?": "Corporation",
        "\\bEW\\b\\.?": "East West",
        "\\bSW\\b\\.?": "South West",
        "\\bSN\\b\\.?": "South North",
        "\\bLLC\\b": "Limited Liability Company",
        "\\bE\\.?W\\.?S\\.?N\\b": "East West South North",
        "\\bCo\\.,": "Company,"
      };

      for (let [pattern, replacement] of Object.entries(replacements)) {
        const regex = new RegExp(pattern, "g");
        text = text.replace(regex, replacement);
      }

      return text.trim();
    }

    async function extractText() {
      const fileInput = document.getElementById("imageInput");
      const resultArea = document.getElementById("result");
      const status = document.getElementById("status");

      if (!fileInput.files.length) {
        status.textContent = "‚ùó Please select an image first.";
        return;
      }

      status.textContent = "‚è≥ Processing...";
      resultArea.value = "";

      const formData = new FormData();
      formData.append("apikey", "bbef5d657f88957");  // ‚úÖ Your real SpaceOCR key
      formData.append("language", "eng");
      formData.append("isOverlayRequired", "false");
      formData.append("OCREngine", "2");
      formData.append("file", fileInput.files[0]);

      try {
        const response = await fetch("https://api.ocr.space/parse/image", {
          method: "POST",
          body: formData
        });

        const data = await response.json();

        if (data.IsErroredOnProcessing) {
          status.textContent = "‚ùå OCR failed. Please check the image or try again.";
        } else {
          const extracted = data.ParsedResults[0].ParsedText;
          const formatted = formatText(extracted);
          resultArea.value = formatted;
          status.textContent = "‚úÖ Text extracted and formatted successfully!";
        }
      } catch (err) {
        console.error(err);
        status.textContent = "‚ö†Ô∏è Network or server error.";
      }
    }
  </script>

</body>
</html>

